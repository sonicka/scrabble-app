(this["webpackJsonpscrabble-club-app"]=this["webpackJsonpscrabble-club-app"]||[]).push([[0],{31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){},41:function(e,t,n){},42:function(e,t,n){"use strict";n.r(t);var r,a=n(0),s=n(1),c=n.n(s),o=n(9),u=n.n(o),i=n(5),l=n(7),d=n(17),b=n(18),f="http://localhost:3000",p="".concat(f,"/leaderBoard"),j="".concat(f,"/users"),v="".concat(f,"/games"),m="SAVE_USERS_BY_WINS",x="SAVE_USERS_BY_SCORE",h="SAVE_USER",O="CLEAR_USER",g="SET_ACTIVE_TAB",w="SET_SHOULD_LOAD_USERS",y="SET_GAME",k="RESET_WON_GAME",S="SET_GAME_INDEX",I="SET_LAST_INDEX",C="SET_IS_LOADING",N="most-wins-tab",E="avg-score-tab",_="users-by-most-wins",U="users-by-score",L="prev",T=n(3),G={game:null,gameIndex:1,lastIndex:5},A=n(8),B=(r={},Object(A.a)(r,_,!1),Object(A.a)(r,U,!1),r),W=Object(l.combineReducers)({usersByScore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return t.payload.users;default:return e}},usersByWins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.payload.users;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(T.a)(Object(T.a)({},e),t.payload.user);case O:return null;default:return e}},activeTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:N,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return t.payload.activeTab;default:return e}},shouldLoadUsers:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return t.payload;default:return e}},wonGame:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:G,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case y:return Object(T.a)(Object(T.a)({},e),{},{game:t.payload.game});case S:return Object(T.a)(Object(T.a)({},e),{},{gameIndex:t.payload.gameIndex});case I:return Object(T.a)(Object(T.a)({},e),{},{lastIndex:t.payload.lastIndex});case k:return G;default:return e}},isLoading:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:B,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case C:return Object(T.a)(Object(T.a)({},e),{},Object(A.a)({},t.payload.key,t.payload.isLoading));default:return e}}}),D=Object(l.createStore)(W,Object(d.composeWithDevTools)(Object(l.applyMiddleware)(b.a))),R=n(15),F=n(2),V=n.n(F),M=n(4),J=function(e){var t=e.wins,n=e.averageScore,r=e.losses,s=e.customClass;return Object(a.jsxs)("div",{className:s,children:[Object(a.jsxs)("div",{children:[t," wins"]}),Object(a.jsx)("div",{children:"|"}),Object(a.jsxs)("div",{children:[n," avg score"]}),Object(a.jsx)("div",{children:"|"}),Object(a.jsxs)("div",{children:[r," losses"]})]})},X=(n(31),function(e){var t=e.name,n=e.wins,r=e.averageScore,s=e.losses,c=e.onClick;return Object(a.jsxs)("div",{className:"user-item-wrap",onClick:c,role:"button",children:[Object(a.jsx)("div",{className:"user-item-name",children:t}),Object(a.jsx)(J,{wins:n,averageScore:r,losses:s,customClass:"user-item-stats"})]})}),H=(n(32),function(e){var t=e.isActive,n=e.onClick,r=e.text;return Object(a.jsx)("div",{className:"leader-board-tab ".concat(t?"active":""),onClick:n,role:"button",children:r})}),P=(n(33),function(){return Object(a.jsxs)("div",{className:"spinner",children:[Object(a.jsx)("div",{className:"cube1"}),Object(a.jsx)("div",{className:"cube2"})]})}),Y=function(){var e=Object(M.a)(V.a.mark((function e(){var t,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(p,"?_sort=wins&_limit=10&_order=desc"));case 3:if(!(t=e.sent).ok){e.next=9;break}return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",n);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting leader board by wins failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),q=function(){var e=Object(M.a)(V.a.mark((function e(){var t,n;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(p,"?_sort=averageScore&_limit=10&_order=desc"));case 3:if(!(t=e.sent).ok){e.next=9;break}return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",n);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting leader board by average score failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),z=function(){var e=Object(M.a)(V.a.mark((function e(t){var n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/").concat(t));case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting user failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),K=function(){var e=Object(M.a)(V.a.mark((function e(t,n,r,a){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,username:r,email:a})});case 3:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",!0);case 8:throw new Error("Updating user failed.");case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),Q=function(){var e=Object(M.a)(V.a.mark((function e(t,n){var r,a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(v,"?scores.0.memberId=").concat(t,"&scores.0.score=").concat(n));case 3:if(!(r=e.sent).ok){e.next=8;break}return e.next=7,r.json();case 7:a=e.sent;case 8:if(a.length){e.next=16;break}return e.next=11,fetch("".concat(v,"?scores.1.memberId=").concat(t,"&scores.1.score=").concat(n));case 11:if(!(r=e.sent).ok){e.next=16;break}return e.next=15,r.json();case 15:a=e.sent;case 16:if(a.length){e.next=18;break}throw new Error("Game not found.");case 18:if(1!==a.length){e.next=20;break}return e.abrupt("return",a[0]);case 20:return e.abrupt("return",a.find((function(e){return e.scores.findIndex((function(e){return e.memberId===t&&e.score===n}))>-1})));case 23:return e.prev=23,e.t0=e.catch(0),console.error("Getting best game failed: ",e.t0),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,n){return e.apply(this,arguments)}}(),Z=function(){var e=Object(M.a)(V.a.mark((function e(t,n){var r,a;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(v,"?winnerId=").concat(t,"&_page=").concat(n,"&_limit=1"));case 3:if(!(r=e.sent).ok){e.next=9;break}return e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",{game:a[0],lastIndex:r.headers.get("X-Total-Count")});case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting games won by user failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}();function $(e){return function(t){t({type:w,payload:e})}}n(34);var ee={setActiveTab:function(e){return function(t){t({type:g,payload:{activeTab:e}})}},saveUser:function(e){return function(t){t({type:h,payload:{user:e}})}}},te=Object(i.b)((function(e){return{activeTab:e.activeTab,isLoading:e.activeTab===N?e.isLoading[_]:e.isLoading[U],users:e.activeTab===N?e.usersByWins:e.usersByScore}}),ee)((function(e){var t=e.users,n=e.activeTab,r=e.setActiveTab,s=e.saveUser,c=e.isLoading,o=function(){var e=Object(M.a)(V.a.mark((function e(t){var n,r,a,c,o,u,i;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userId,r=t.highestScore,a=r.against,c=r.score,e.next=3,Q(n,c);case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return");case 6:return e.next=8,z(a);case 8:(u=e.sent)&&(i={opponentName:u.name,opponentId:u.id,won:o.winnerId===n,score:c,date:o.createdAt},s(Object(T.a)(Object(T.a)({},t),{},{bestGame:i})));case 10:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),u=function(e){e!==n&&r(e)};return Object(a.jsxs)("div",{className:"leader-board-wrap",children:[Object(a.jsxs)("div",{className:"leader-board-tabs",children:[Object(a.jsx)(H,{isActive:n===N,onClick:function(){return u(N)},text:"Most wins"}),Object(a.jsx)(H,{isActive:n===E,onClick:function(){return u(E)},text:"Average score"})]}),Object(a.jsx)("div",{className:"leader-board-users-list",children:c?Object(a.jsx)(P,{}):(null===t||void 0===t?void 0:t.length)?t.map((function(e){return Object(a.jsx)(X,{name:e.name,wins:e.wins,averageScore:e.averageScore,losses:e.losses,onClick:function(){return o(e)}},e.userId)})):Object(a.jsx)("div",{className:"leader-board-error",children:"Players could not be loaded, please try again later."})})]})})),ne=n(6),re=(n(35),function(e){var t=e.id,n=e.isEditing,r=e.originalValue,c=e.handleChange,o=e.customClass,u=Object(s.useState)(r),i=Object(ne.a)(u,2),l=i[0],d=i[1],b=Object(s.useState)(!0),f=Object(ne.a)(b,2),p=f[0],j=f[1];Object(s.useEffect)((function(){n||(d(r),j(!0))}),[n,r]);return n?Object(a.jsx)("input",{type:"text",name:t,value:l,onChange:function(e){d(e.target.value),c(e.target.value,p),j(!!e.target.value)},className:"text-field ".concat(p?"":"invalid-input")}):Object(a.jsx)("div",{className:o,children:l})}),ae=function(e){var t=e.text,n=e.onClick,r=e.customClass,s=e.disabled;return Object(a.jsx)("button",{className:r||"",onClick:n,disabled:s,children:t})},se=(n(36),{setShouldLoadUsers:$}),ce=Object(i.b)((function(e){var t=e.user;return{userId:t.userId,nameFromState:t.name,userNameFromState:t.username,emailFromState:t.email}}),se)((function(e){var t,n=e.userId,r=e.nameFromState,c=e.userNameFromState,o=e.emailFromState,u=e.setShouldLoadUsers,i=Object(s.useState)(null),l=Object(ne.a)(i,2),d=l[0],b=l[1],f=Object(s.useState)(r),p=Object(ne.a)(f,2),j=p[0],v=p[1],m=Object(s.useState)(c),x=Object(ne.a)(m,2),h=x[0],O=x[1],g=Object(s.useState)(o),w=Object(ne.a)(g,2),y=w[0],k=w[1],S=Object(s.useState)(!0),I=Object(ne.a)(S,2),C=I[0],N=I[1];Object(s.useEffect)((function(){N(t())}),[j,h,y,t]);var E=function(){return b(!0)};t=function(){return j&&h&&y};var _=function(){var e=Object(M.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r===j&&c===h&&o===y){e.next=5;break}return e.next=3,K(n,j,h,y);case 3:e.sent?u(!0):L();case 5:b(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),U=function(){L(),b(!1)},L=function(){v(r),O(c),k(o)};return Object(a.jsxs)("div",{className:"user-details-section-wrap",children:[Object(a.jsxs)("div",{className:"text-field-wrap",children:[Object(a.jsx)(re,{customClass:"title-field",id:"name",originalValue:j,isEditing:d,handleChange:v}),Object(a.jsx)(re,{customClass:"subtitle-field",id:"username",originalValue:h,isEditing:d,handleChange:O}),Object(a.jsx)(re,{customClass:"subtitle-field",id:"email",originalValue:y,isEditing:d,handleChange:k})]}),d?Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)(ae,{text:"Save",onClick:_,customClass:"form-btn",disabled:!C}),Object(a.jsx)(ae,{text:"Cancel",onClick:U,customClass:"form-btn"})]}):Object(a.jsx)(ae,{text:"Edit details",onClick:E,customClass:"edit-btn"})]})})),oe=(n(37),function(e){var t=e.name,n=e.won,r=e.score,s=e.opponent,c=e.date;return Object(a.jsxs)("div",{className:"highest-score-wrap",children:[Object(a.jsx)("div",{className:"highest-score-subtitle",children:"Highest score"}),Object(a.jsxs)("div",{children:[Object(a.jsx)("b",{children:t})," ",n?"won":"lost"," with ",Object(a.jsxs)("b",{children:[r," points"]})," against ",Object(a.jsx)("b",{children:s})," ",c&&"on ".concat(c)]})]})}),ue=(n(38),function(e){var t=e.name,n=e.game,r=e.fetchGameWonByUser,s=e.gameIndex,c=e.lastIndex,o=n.opponentName,u=n.playerScore,i=n.opponentScore,l=n.date;return Object(a.jsxs)(a.Fragment,{children:[Object(a.jsx)("div",{className:"won-games-title",children:"Won games"}),Object(a.jsxs)("div",{className:"won-games-wrap",children:[Object(a.jsx)("div",{className:s>1?"":"button-hidden",children:Object(a.jsx)(ae,{onClick:function(){return r(L)},text:"<"})}),n&&Object(a.jsxs)("div",{className:"won-games-text",children:[t," vs. ",o," (",u," : ",i,") ",l&&"on ".concat(new Date(l).toLocaleString())]}),Object(a.jsx)("div",{className:s<c?"":"button-hidden",children:Object(a.jsx)(ae,{onClick:function(){return r("next")},text:">"})})]})]})}),ie=(n(39),{setGame:function(e){return function(t){t({type:y,payload:{game:e}})}},setGameIndex:function(e){return function(t){t({type:S,payload:{gameIndex:e}})}},setLastIndex:function(e){return function(t){t({type:I,payload:{lastIndex:e}})}}}),le=Object(i.b)((function(e){var t=e.user,n=e.wonGame;return{user:t,game:n.game,gameIndex:n.gameIndex,lastIndex:n.lastIndex}}),ie)((function(e){var t,n=e.hideUserDetail,r=e.user,c=e.game,o=e.gameIndex,u=e.lastIndex,i=e.setGame,l=e.setGameIndex,d=e.setLastIndex,b=r.userId,f=r.name,p=r.username,j=r.email,v=r.averageScore,m=r.wins,x=r.losses,h=r.bestGame,O=h.opponentName,g=h.date,w=h.score,y=h.won;return Object(s.useEffect)((function(){m&&function(){var e=Object(M.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,m]),t=function(){var e=Object(M.a)(V.a.mark((function e(t){var n,r,a,s,c,u,f,p,j,v;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=o,t||d(m<5?m:5),t&&l(n=t===L?o-1:o+1),e.next=5,Z(b,n);case 5:if(!(r=e.sent)){e.next=13;break}if(!(a=r.game.scores.find((function(e){return e.memberId!==b})).memberId)){e.next=13;break}return e.next=11,z(a);case 11:s=e.sent,O&&(f=r.game.createdAt||"",p=null===(c=r.game.scores.find((function(e){return e.memberId===b})))||void 0===c?void 0:c.score,j=null===(u=r.game.scores.find((function(e){return e.memberId===a})))||void 0===u?void 0:u.score,v={opponentName:s.name||"",date:f,playerScore:p,opponentScore:j},i(v));case 13:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(a.jsxs)("div",{className:"user-popup-wrap",children:[Object(a.jsx)("div",{className:"user-popup-overlay",onClick:n,role:"button"}),Object(a.jsxs)("div",{className:"user-popup",children:[Object(a.jsx)(ce,{name:f,username:p,email:j}),Object(a.jsx)(J,{wins:m,averageScore:v,losses:x,customClass:"user-popup-stats"}),Object(a.jsx)(oe,{name:f,won:y,score:w,opponent:O,date:g?new Date(g).toLocaleString():""}),c&&Object(a.jsx)(ue,{userId:b,name:f,game:c,fetchGameWonByUser:t,gameIndex:o,lastIndex:u}),Object(a.jsx)(ae,{text:"\u2715",onClick:n,customClass:"user-popup-close-btn"})]})]})})),de=(n(40),{saveUsersByWins:function(e){return function(t){t({type:m,payload:{users:e}})}},saveUsersByScore:function(e){return function(t){t({type:x,payload:{users:e}})}},clearUser:function(){return function(e){e({type:O})}},resetWonGame:function(){return function(e){e({type:k})}},setShouldLoadUsers:$,setIsLoading:function(e,t){return function(n){n({type:C,payload:{key:e,isLoading:t}})}}}),be=Object(i.b)((function(e){return{detailShown:!!e.user,shouldLoadUsers:e.shouldLoadUsers}}),de)((function(e){var t,n,r=e.saveUsersByWins,c=e.saveUsersByScore,o=e.clearUser,u=e.resetWonGame,i=e.setShouldLoadUsers,l=e.detailShown,d=e.shouldLoadUsers,b=e.setIsLoading;Object(s.useEffect)((function(){var e=function(){var e=Object(M.a)(V.a.mark((function e(){return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return b(_,!1),e.next=5,n();case 5:b(U,!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();i(!1),d&&(b(_,!0),b(U,!0),e())}),[d,t,n,i,b]),t=function(){var e=Object(M.a)(V.a.mark((function e(){var t,n,a,s,c,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Y();case 2:if(t=e.sent){e.next=6;break}return r(t),e.abrupt("return");case 6:n=[],a=Object(R.a)(t),e.prev=8,a.s();case 10:if((s=a.n()).done){e.next=18;break}return c=s.value,e.next=14,f(c);case 14:(o=e.sent)&&n.push(o);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),a.e(e.t0);case 23:return e.prev=23,a.f(),e.finish(23);case 26:r(n);case 27:case"end":return e.stop()}}),e,null,[[8,20,23,26]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(M.a)(V.a.mark((function e(){var t,n,r,a,s,o;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q();case 2:if(t=e.sent){e.next=6;break}return c(t),e.abrupt("return");case 6:n=[],r=Object(R.a)(t),e.prev=8,r.s();case 10:if((a=r.n()).done){e.next=18;break}return s=a.value,e.next=14,f(s);case 14:(o=e.sent)&&n.push(o);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),r.e(e.t0);case 23:return e.prev=23,r.f(),e.finish(23);case 26:c(n);case 27:case"end":return e.stop()}}),e,null,[[8,20,23,26]])})));return function(){return e.apply(this,arguments)}}();var f=function(){var e=Object(M.a)(V.a.mark((function e(t){var n,r;return V.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,z(t.userId);case 2:if(!(n=e.sent)){e.next=6;break}return r=Object(T.a)(Object(T.a)({},t),n),e.abrupt("return",r);case 6:return e.abrupt("return",null);case 7:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(a.jsxs)("div",{className:"app ".concat(l?"no-scroll":""),children:[Object(a.jsx)(te,{}),l&&Object(a.jsx)(le,{hideUserDetail:function(){o(),u()}})]})}));n(41);u.a.render(Object(a.jsx)(c.a.StrictMode,{children:Object(a.jsx)(i.a,{store:D,children:Object(a.jsx)(be,{})})}),document.getElementById("root"))}},[[42,1,2]]]);
//# sourceMappingURL=main.86ea8cae.chunk.js.map