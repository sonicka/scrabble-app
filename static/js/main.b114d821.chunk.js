(this["webpackJsonpscrabble-club-app"]=this["webpackJsonpscrabble-club-app"]||[]).push([[0],{30:function(e,t,n){},31:function(e,t,n){},32:function(e,t,n){},33:function(e,t,n){},34:function(e,t,n){},35:function(e,t,n){},36:function(e,t,n){},37:function(e,t,n){},38:function(e,t,n){},39:function(e,t,n){},40:function(e,t,n){"use strict";n.r(t);var r=n(0),a=n(1),s=n.n(a),c=n(8),o=n.n(c),u=n(5),i=n(7),l=n(16),d=n(17),b="http://localhost:3000",p="".concat(b,"/leaderBoard"),f="".concat(b,"/users"),j="".concat(b,"/games"),v="SAVE_USERS_BY_WINS",m="SAVE_USERS_BY_SCORE",x="SAVE_USER",h="CLEAR_USER",O="SET_ACTIVE_TAB",g="SET_SHOULD_LOAD_USERS",w="SET_GAME",y="RESET_WON_GAME",k="SET_GAME_INDEX",S="SET_LAST_INDEX",I="most-wins-tab",C="avg-score-tab",E="prev",N=n(4),U={game:null,gameIndex:1,lastIndex:5},_=Object(i.combineReducers)({usersByScore:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case m:return t.payload.users;default:return e}},usersByWins:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case v:return t.payload.users;default:return e}},user:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case x:return Object(N.a)(Object(N.a)({},e),t.payload.user);case h:return null;default:return e}},activeTab:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:I,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return t.payload.activeTab;default:return e}},shouldLoadUsers:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:return t.payload;default:return e}},wonGame:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:U,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case w:return Object(N.a)(Object(N.a)({},e),{},{game:t.payload.game});case k:return Object(N.a)(Object(N.a)({},e),{},{gameIndex:t.payload.gameIndex});case S:return Object(N.a)(Object(N.a)({},e),{},{lastIndex:t.payload.lastIndex});case y:return U;default:return e}}}),T=Object(i.createStore)(_,Object(l.composeWithDevTools)(Object(i.applyMiddleware)(d.a))),G=n(14),A=n(2),L=n.n(A),B=n(3),W=function(e){var t=e.wins,n=e.averageScore,a=e.losses,s=e.customClass;return Object(r.jsxs)("div",{className:s,children:[Object(r.jsxs)("div",{children:[t," wins"]}),Object(r.jsx)("div",{children:"|"}),Object(r.jsxs)("div",{children:[n," avg score"]}),Object(r.jsx)("div",{children:"|"}),Object(r.jsxs)("div",{children:[a," losses"]})]})},D=(n(30),function(e){var t=e.name,n=e.wins,a=e.averageScore,s=e.losses,c=e.onClick;return Object(r.jsxs)("div",{className:"user-item-wrap",onClick:c,role:"button",children:[Object(r.jsx)("div",{className:"user-item-name",children:t}),Object(r.jsx)(W,{wins:n,averageScore:a,losses:s,customClass:"user-item-stats"})]})}),R=(n(31),function(e){var t=e.isActive,n=e.onClick,a=e.text;return Object(r.jsx)("div",{className:"leader-board-tab ".concat(t?"active":""),onClick:n,role:"button",children:a})}),F=function(){var e=Object(B.a)(L.a.mark((function e(){var t,n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(p,"?_sort=wins&_limit=10&_order=desc"));case 3:if(!(t=e.sent).ok){e.next=9;break}return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",n);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting leader board by wins failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),V=function(){var e=Object(B.a)(L.a.mark((function e(){var t,n;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(p,"?_sort=averageScore&_limit=10&_order=desc"));case 3:if(!(t=e.sent).ok){e.next=9;break}return e.next=7,t.json();case 7:return n=e.sent,e.abrupt("return",n);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting leader board by average score failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(){return e.apply(this,arguments)}}(),M=function(){var e=Object(B.a)(L.a.mark((function e(t){var n,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(f,"/").concat(t));case 3:if(!(n=e.sent).ok){e.next=9;break}return e.next=7,n.json();case 7:return r=e.sent,e.abrupt("return",r);case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting user failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t){return e.apply(this,arguments)}}(),J=function(){var e=Object(B.a)(L.a.mark((function e(t,n,r,a){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(f,"/").concat(t),{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:n,username:r,email:a})});case 3:if(!e.sent.ok){e.next=8;break}return e.abrupt("return",!0);case 8:throw new Error("Updating user failed.");case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error(e.t0),e.abrupt("return",!1);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n,r,a){return e.apply(this,arguments)}}(),X=function(){var e=Object(B.a)(L.a.mark((function e(t,n,r){var a,s;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"?scores.0.memberId=").concat(t,"&scores.0.score=").concat(r));case 3:if(!(a=e.sent).ok){e.next=8;break}return e.next=7,a.json();case 7:s=e.sent;case 8:if(s.length){e.next=16;break}return e.next=11,fetch("".concat(j,"?scores.1.memberId=").concat(t,"&scores.1.score=").concat(r));case 11:if(!(a=e.sent).ok){e.next=16;break}return e.next=15,a.json();case 15:s=e.sent;case 16:if(s.length){e.next=18;break}throw new Error("Game not found.");case 18:if(1!==s.length){e.next=20;break}return e.abrupt("return",s[0]);case 20:return e.abrupt("return",s.find((function(e){return e.scores.findIndex((function(e){return e.memberId===t&&e.score===r}))>-1})));case 23:return e.prev=23,e.t0=e.catch(0),console.error("Getting game with highest score failed: ",e.t0),e.abrupt("return",null);case 27:case"end":return e.stop()}}),e,null,[[0,23]])})));return function(t,n,r){return e.apply(this,arguments)}}(),H=function(){var e=Object(B.a)(L.a.mark((function e(t,n){var r,a;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,fetch("".concat(j,"?winnerId=").concat(t,"&_page=").concat(n,"&_limit=1"));case 3:if(!(r=e.sent).ok){e.next=9;break}return e.next=7,r.json();case 7:return a=e.sent,e.abrupt("return",{game:a[0],lastIndex:r.headers.get("X-Total-Count")});case 9:e.next=15;break;case 11:return e.prev=11,e.t0=e.catch(0),console.error("Getting games won by user failed: ",e.t0),e.abrupt("return",null);case 15:case"end":return e.stop()}}),e,null,[[0,11]])})));return function(t,n){return e.apply(this,arguments)}}();function P(e){return function(t){t({type:g,payload:e})}}n(32);var Y={setActiveTab:function(e){return function(t){t({type:O,payload:{activeTab:e}})}},saveUser:function(e){return function(t){t({type:x,payload:{user:e}})}}},q=Object(u.b)((function(e){return{activeTab:e.activeTab,users:e.activeTab===I?e.usersByWins:e.usersByScore}}),Y)((function(e){var t=e.users,n=e.activeTab,a=e.setActiveTab,s=e.saveUser,c=function(){var e=Object(B.a)(L.a.mark((function e(t){var n,r,a,c,o,u,i;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.userId,r=t.highestScore,a=r.against,c=r.score,e.next=3,X(n,a,c);case 3:if(o=e.sent){e.next=6;break}return e.abrupt("return",t);case 6:return e.next=8,M(a);case 8:u=e.sent,i={opponentName:u.name,opponentId:u.id,won:o.winnerId===n,score:c,date:o.createdAt},s(Object(N.a)(Object(N.a)({},t),{},{bestGame:i}));case 11:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"leader-board-wrap",children:[Object(r.jsxs)("div",{className:"leader-board-tabs",children:[Object(r.jsx)(R,{isActive:n===I,onClick:function(){return a(I)},text:"Most wins"}),Object(r.jsx)(R,{isActive:n===C,onClick:function(){return a(C)},text:"Average score"})]}),Object(r.jsx)("div",{className:"leader-board-users-list",children:t?t.map((function(e){return Object(r.jsx)(D,{name:e.name,wins:e.wins,averageScore:e.averageScore,losses:e.losses,onClick:function(){return c(e)}},e.userId)})):Object(r.jsx)("div",{className:"leader-board-error",children:"Players could not be loaded, please try again later."})})]})})),z=n(6),K=(n(33),function(e){var t=e.id,n=e.isEditing,s=e.originalValue,c=e.handleChange,o=e.customClass,u=Object(a.useState)(s),i=Object(z.a)(u,2),l=i[0],d=i[1],b=Object(a.useState)(!0),p=Object(z.a)(b,2),f=p[0],j=p[1];Object(a.useEffect)((function(){n||(d(s),j(!0))}),[n,s]);return n?Object(r.jsx)("input",{type:"text",name:t,value:l,onChange:function(e){d(e.target.value),c(e.target.value,f),j(!!e.target.value)},className:"text-field ".concat(f?"":"invalid-input")}):Object(r.jsx)("div",{className:o,children:l})}),Q=function(e){var t=e.text,n=e.onClick,a=e.customClass,s=e.disabled;return Object(r.jsx)("button",{className:a||"",onClick:n,disabled:s,children:t})},Z=(n(34),{setShouldLoadUsers:P}),$=Object(u.b)((function(e){var t=e.user;return{userId:t.userId,nameFromState:t.name,userNameFromState:t.username,emailFromState:t.email}}),Z)((function(e){var t,n=e.userId,s=e.nameFromState,c=e.userNameFromState,o=e.emailFromState,u=e.setShouldLoadUsers,i=Object(a.useState)(null),l=Object(z.a)(i,2),d=l[0],b=l[1],p=Object(a.useState)(s),f=Object(z.a)(p,2),j=f[0],v=f[1],m=Object(a.useState)(c),x=Object(z.a)(m,2),h=x[0],O=x[1],g=Object(a.useState)(o),w=Object(z.a)(g,2),y=w[0],k=w[1],S=Object(a.useState)(!0),I=Object(z.a)(S,2),C=I[0],E=I[1];Object(a.useEffect)((function(){E(t())}),[j,h,y,t]);var N=function(){return b(!0)};t=function(){return j&&h&&y};var U=function(){var e=Object(B.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(s===j&&c===h&&o===y){e.next=5;break}return e.next=3,J(n,j,h,y);case 3:e.sent?u(!0):T();case 5:b(!1);case 6:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),_=function(){T(),b(!1)},T=function(){v(s),O(c),k(o)};return Object(r.jsxs)("div",{className:"user-details-section-wrap",children:[Object(r.jsxs)("div",{className:"text-field-wrap",children:[Object(r.jsx)(K,{customClass:"title-field",id:"name",originalValue:j,isEditing:d,handleChange:v}),Object(r.jsx)(K,{customClass:"subtitle-field",id:"username",originalValue:h,isEditing:d,handleChange:O}),Object(r.jsx)(K,{customClass:"subtitle-field",id:"email",originalValue:y,isEditing:d,handleChange:k})]}),d?Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)(Q,{text:"Save",onClick:U,customClass:"popup-form-btn",disabled:!C}),Object(r.jsx)(Q,{text:"Cancel",onClick:_,customClass:"popup-form-btn"})]}):Object(r.jsx)(Q,{text:"Edit details",onClick:N,customClass:"popup-edit-btn"})]})})),ee=(n(35),function(e){var t=e.name,n=e.won,a=e.score,s=e.opponent,c=e.date;return Object(r.jsxs)("div",{className:"highest-score-wrap",children:[Object(r.jsx)("div",{className:"highest-score-subtitle",children:"Highest score"}),Object(r.jsxs)("div",{children:[Object(r.jsx)("b",{children:t})," ",n?"won":"lost"," with ",Object(r.jsxs)("b",{children:[a," points"]})," against ",Object(r.jsx)("b",{children:s})," ",c&&"on ".concat(c)]})]})}),te=(n(36),function(e){var t=e.name,n=e.game,a=e.fetchGameWonByUser,s=e.gameIndex,c=e.lastIndex,o=n.opponentName,u=n.playerScore,i=n.opponentScore,l=n.date;return Object(r.jsxs)(r.Fragment,{children:[Object(r.jsx)("div",{className:"won-games-title",children:"Won games"}),Object(r.jsxs)("div",{className:"won-games-wrap",children:[Object(r.jsx)("div",{className:s>1?"":"button-hidden",children:Object(r.jsx)(Q,{onClick:function(){return a(E)},text:"<"})}),n&&Object(r.jsxs)("div",{className:"won-games-text",children:[t," vs. ",o," (",u," : ",i,") ",l&&"on ".concat(new Date(l).toLocaleString())]}),Object(r.jsx)("div",{className:s<c?"":"button-hidden",children:Object(r.jsx)(Q,{onClick:function(){return a("next")},text:">"})})]})]})}),ne=(n(37),{setGame:function(e){return function(t){t({type:w,payload:{game:e}})}},setGameIndex:function(e){return function(t){t({type:k,payload:{gameIndex:e}})}},setLastIndex:function(e){return function(t){t({type:S,payload:{lastIndex:e}})}}}),re=Object(u.b)((function(e){var t=e.user,n=e.wonGame;return{user:t,game:n.game,gameIndex:n.gameIndex,lastIndex:n.lastIndex}}),ne)((function(e){var t,n=e.hideUserDetail,s=e.user,c=e.game,o=e.gameIndex,u=e.lastIndex,i=e.setGame,l=e.setGameIndex,d=e.setLastIndex,b=s.userId,p=s.name,f=s.username,j=s.email,v=s.averageScore,m=s.wins,x=s.losses,h=s.bestGame,O=h.opponentName,g=h.date,w=h.score,y=h.won;return Object(a.useEffect)((function(){m&&function(){var e=Object(B.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[t,m]),t=function(){var e=Object(B.a)(L.a.mark((function e(t){var n,r,a,s,c,u,p,f,j,v;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return a=o,t||d(m<5?m:5),t&&l(a=t===E?o-1:o+1),e.next=5,H(b,a);case 5:return s=e.sent,c=s.game.scores.find((function(e){return e.memberId!==b})).memberId,e.next=9,M(c);case 9:u=e.sent,p=s.game.createdAt||"",f=null===(n=s.game.scores.find((function(e){return e.memberId===b})))||void 0===n?void 0:n.score,j=null===(r=s.game.scores.find((function(e){return e.memberId===c})))||void 0===r?void 0:r.score,v={opponentName:u.name||"",date:p,playerScore:f,opponentScore:j},i(v);case 15:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),Object(r.jsxs)("div",{className:"user-popup-wrap",children:[Object(r.jsx)("div",{className:"user-popup-overlay",onClick:n,role:"button"}),Object(r.jsxs)("div",{className:"user-popup",children:[Object(r.jsx)($,{name:p,username:f,email:j}),Object(r.jsx)(W,{wins:m,averageScore:v,losses:x,customClass:"user-stats"}),Object(r.jsx)(ee,{name:p,won:y,score:w,opponent:O,date:g?new Date(g).toLocaleString():""}),c&&Object(r.jsx)(te,{userId:b,name:p,game:c,fetchGameWonByUser:t,gameIndex:o,lastIndex:u}),Object(r.jsx)(Q,{text:"\u2715",onClick:n,customClass:"user-popup-close-btn"})]})]})})),ae=(n(38),{saveUsersByWins:function(e){return function(t){t({type:v,payload:{users:e}})}},saveUsersByScore:function(e){return function(t){t({type:m,payload:{users:e}})}},clearUser:function(){return function(e){e({type:h})}},resetWonGame:function(){return function(e){e({type:y})}},setShouldLoadUsers:P}),se=Object(u.b)((function(e){return{detailShown:!!e.user,shouldLoadUsers:e.shouldLoadUsers}}),ae)((function(e){var t,n,s=e.saveUsersByWins,c=e.saveUsersByScore,o=e.clearUser,u=e.resetWonGame,i=e.setShouldLoadUsers,l=e.detailShown,d=e.shouldLoadUsers;Object(a.useEffect)((function(){d&&function(){var e=Object(B.a)(L.a.mark((function e(){return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t();case 2:return e.next=4,n();case 4:i(!1);case 5:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()()}),[d,t,n,i]),t=function(){var e=Object(B.a)(L.a.mark((function e(){var t,n,r,a,c,o;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,F();case 2:if(t=e.sent){e.next=6;break}return s(t),e.abrupt("return");case 6:n=[],r=Object(G.a)(t),e.prev=8,r.s();case 10:if((a=r.n()).done){e.next=18;break}return c=a.value,e.next=14,b(c);case 14:o=e.sent,n.push(o);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),r.e(e.t0);case 23:return e.prev=23,r.f(),e.finish(23);case 26:s(n);case 27:case"end":return e.stop()}}),e,null,[[8,20,23,26]])})));return function(){return e.apply(this,arguments)}}(),n=function(){var e=Object(B.a)(L.a.mark((function e(){var t,n,r,a,s,o;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V();case 2:if(t=e.sent){e.next=6;break}return c(t),e.abrupt("return");case 6:n=[],r=Object(G.a)(t),e.prev=8,r.s();case 10:if((a=r.n()).done){e.next=18;break}return s=a.value,e.next=14,b(s);case 14:o=e.sent,n.push(o);case 16:e.next=10;break;case 18:e.next=23;break;case 20:e.prev=20,e.t0=e.catch(8),r.e(e.t0);case 23:return e.prev=23,r.f(),e.finish(23);case 26:c(n);case 27:case"end":return e.stop()}}),e,null,[[8,20,23,26]])})));return function(){return e.apply(this,arguments)}}();var b=function(){var e=Object(B.a)(L.a.mark((function e(t){var n,r;return L.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,M(t.userId);case 2:return n=e.sent,r=Object(N.a)(Object(N.a)({},t),n),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(r.jsxs)("div",{className:"app ".concat(l?"no-scroll":""),children:[Object(r.jsx)(q,{}),l&&Object(r.jsx)(re,{hideUserDetail:function(){o(),u()}})]})}));n(39);o.a.render(Object(r.jsx)(s.a.StrictMode,{children:Object(r.jsx)(u.a,{store:T,children:Object(r.jsx)(se,{})})}),document.getElementById("root"))}},[[40,1,2]]]);
//# sourceMappingURL=main.b114d821.chunk.js.map